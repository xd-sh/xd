#!/usr/bin/env bash

set -e # exit on error
set -o pipefail # exit on error in pipeline

source ruby.sh

git_is_clean() {
	git diff --quiet && git diff --cached --quiet
}

git_is_not_clean() {
	! git_is_clean
}

git_is_on_master() {
	[[ "$(git rev-parse --abbrev-ref HEAD)" == "master" ]]
}

# if git_is_not_clean; then
# 	error git is not clean
# 	exit 1
# fi

new_version=$1
version_path="$(root_dir)/VERSION"

if is_empty $new_version; then
	error Give me a new version value!
	exit  2
fi

echo "current version: $version_path"
echo "    new version: $new_version"

echo "Ctrl+C to exit / Enter continue"
read

echo $new_version > $version_path
git add $version_path
git commit --message="release version $new_version"
